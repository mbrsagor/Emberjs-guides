{% load static wagtailuserbar compress sekizai_tags i18n %}

<!DOCTYPE html>
{% get_current_language as LANG %}
<html class="no-js" lang="{{ LANG }}">
    <head>
        <meta charset="utf-8" />
        <title>{% block title %}{% if self.seo_title %}{{ self.seo_title }}{% else %}{{ self.title }}{% endif %}{% endblock %}{% block title_suffix %}{% with self.get_site.site_name as site_name %}{% if site_name %} - {{ site_name }}{% endif %}{% endwith %}{% endblock %}</title>

        {% include 'partials/meta_tags.html' %}

        {% if settings.base.ApplicationSettings.website_favicon_icon %}
            <link rel="icon" href="{{ settings.base.ApplicationSettings.website_favicon_icon.url }}">
        {% else %}
            <link rel="icon" href="{% static 'themes/default/img/favicon.ico' %}">
        {% endif %}

        {% compress css file base %}
            <!--live min css-->
            <link href="{% static 'css/live.min.css' %}" type="text/css" rel="stylesheet">
            <!-- responsive css -->
            <link href="{% static 'css/responsive.css' %}" type="text/css" rel="stylesheet">
            <link rel="stylesheet" type="text/css" href="{% static 'css/animate.css' %}" />
        {% endcompress %}

        {% compress css %}
            <link rel="stylesheet" type="text/scss" href="{% static 'themes/theme-6/scss/application.scss' %}"/>
        {% endcompress %}

        {% render_block "css" postprocessor "compressor.contrib.sekizai.compress" %}

    </head>

    <body class="{% block body_class %}{% endblock %}">

        {% wagtailuserbar %}
        {% block content %}{% endblock %}


        {% compress js file base %}
            <script src="{% static 'js/vendor/modernizr-2.8.1.min.js' %}"></script>
            <!--slicknav js-->
            <script src="{% static 'js/live.min.js' %}"></script>
            <!-- custom script -->
            <script src="{% static 'js/scripts.js' %}"></script>
        {% endcompress %}

        {% render_block "js" postprocessor "compressor.contrib.sekizai.compress" %}

        {% render_block "js-inline" %}

        {% if settings.base.ApplicationSettings.google_analytics_key %}
            {% with settings.base.ApplicationSettings.google_analytics_key as ga_key %}
                <!-- Global site tag (gtag.js) - Google Analytics -->
                <script async src="https://www.googletagmanager.com/gtag/js?id={{ ga_key|safe }}"></script>
                    <script>
                 window.dataLayer = window.dataLayer || [];
                 function gtag(){dataLayer.push(arguments);}
                 gtag('js', new Date());

                 gtag('config', '{{ ga_key|safe }}');
                </script>
            {% endwith %}
        {% endif %}

        <script>

             (function(){

                $('body').append('<div id="toTop"><span><i class="fa fa-angle-down"></i></span></div>');

                $(window).scroll(function () {
                    if ($(this).scrollTop() != 0) {
                        $('#toTop').fadeIn();
                    } else {
                        $('#toTop').fadeOut();
                    }
                });

                $('#toTop').on('click',function(){
                    $("html, body").animate({ scrollTop: 0 }, 600);
                    return false;
                });

            }());


              //  4. jQuery to collapse the navbar on scroll
                window.onscroll = function() {myFunction()};

                    var header = document.getElementById("header");
                    var sticky = header.offsetTop;

                    function myFunction() {
                      if (window.pageYOffset > sticky) {
                        header.classList.add("sticky");
                      } else {
                        header.classList.remove("sticky");
                      }
                    }
        </script>

         {# lazy load#}
        <script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@12.0.0/dist/lazyload.min.js"></script>
        {% comment %} <script src="{% static 'divineit/js/toolbar.js' %}?v=1"></script> {% endcomment %}

        {% if settings.base.ApplicationSettings.product_toolbar_base_url %}
            <script type="text/javascript">
                (function () {
                    var base_url = '{{ settings.base.ApplicationSettings.product_toolbar_base_url }}'
                    function onToolbarCodeLoaded() {
                        DivineToolbar(base_url, '100px', false)
                    }
                    if(typeof DivineToolbar=='undefined') {
                        var plTag = document.createElement('script');
                        plTag.type = 'text/javascript';
                        plTag.src = base_url + '/static/divineit/js/toolbar.js?v=1';
                        plTag.onload = onToolbarCodeLoaded;
                        document.body.appendChild(plTag);
                    }
                })()
            </script>
        {% endif %}
        <script type="text/javascript">
            (function () {
                var tags = document.getElementsByTagName('a')
                for (var i = 0; i<tags.length; i++) {
                    var elem = tags[i]
                    console.log(elem.href)
                    if(elem.href.startsWith('http') && elem.href.indexOf(window.location.hostname) < 0) {
                        elem.setAttribute('target', '_blank')
                    }
                }
            })()
        </script>

    </body>
</html>



